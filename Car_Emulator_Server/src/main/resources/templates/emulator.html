<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>차량 에뮬레이터</title>
</head>
<body>
<h1>250대 차량 목록</h1>

<table border="1" cellpadding="4">
    <thead>
    <tr><th>번호판</th><th>상태</th><th>ON</th><th>OFF</th></tr>
    </thead>
    <tbody>
    <tr th:each="car : ${cars}">
        <td th:text="${car.number}">28나3920</td>
        <td th:text="${car.state}">OFF</td>

        <td>
            <button
                    th:attr="onclick=|toggle('${car.number}','ON')|"
                    th:disabled="${car.state == T(com.example.car_emulator_server.util.CarState).ON}">
                ON
            </button>
        </td>
        <td>
            <button
                    th:attr="onclick=|toggle('${car.number}','OFF')|"
                    th:disabled="${car.state == T(com.example.car_emulator_server.util.CarState).OFF}">
                OFF
            </button>
        </td>
    </tr>
    </tbody>
</table>

<script>
    function toggle(number, cmd) {
        fetch(`/emulator/${number}/${cmd}`, {method:'POST'})
            .then(r => r.ok ? location.reload() : r.text().then(alert));
    }
</script>
</body>
</html>
